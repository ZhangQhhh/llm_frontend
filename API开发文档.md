# çš–ç¾æ™ºè„‘ - API æ¥å£å¼€å‘æ–‡æ¡£

> **æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
> **æ›´æ–°æ—¥æœŸ**: 2026-01-29  
> **é€‚ç”¨èŒƒå›´**: å‰ç«¯é¡¹ç›® API æ¥å£è¯´æ˜ï¼Œç”¨äºåç«¯è¿ç§»å’Œé¡¹ç›®ç†è§£

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
4. [è®¤è¯ä¸æˆæƒ](#è®¤è¯ä¸æˆæƒ)
5. [ç”¨æˆ·è®¤è¯æ¨¡å—](#ç”¨æˆ·è®¤è¯æ¨¡å—)
6. [ç®¡ç†å‘˜æ¨¡å—](#ç®¡ç†å‘˜æ¨¡å—)
7. [è¶…çº§ç®¡ç†å‘˜æ¨¡å—](#è¶…çº§ç®¡ç†å‘˜æ¨¡å—)
8. [çŸ¥è¯†é—®ç­”æ¨¡å—](#çŸ¥è¯†é—®ç­”æ¨¡å—)
9. [å¤šè½®å¯¹è¯æ¨¡å—](#å¤šè½®å¯¹è¯æ¨¡å—)
10. [åé¦ˆæ¨¡å—](#åé¦ˆæ¨¡å—)
11. [é¢˜åº“ç®¡ç†æ¨¡å—(MCQ)](#é¢˜åº“ç®¡ç†æ¨¡å—mcq)
12. [è€ƒè¯•æ¨¡å—](#è€ƒè¯•æ¨¡å—)
13. [çŸ¥è¯†åº“ç®¡ç†æ¨¡å—](#çŸ¥è¯†åº“ç®¡ç†æ¨¡å—)
14. [é—®ç­”æ—¥å¿—æ¨¡å—](#é—®ç­”æ—¥å¿—æ¨¡å—)
15. [å†™ä½œæ—¥å¿—æ¨¡å—](#å†™ä½œæ—¥å¿—æ¨¡å—)
16. [è§†é¢‘ä¸­å¿ƒæ¨¡å—](#è§†é¢‘ä¸­å¿ƒæ¨¡å—)
17. [ç”¨æˆ·éƒ¨é—¨ç®¡ç†](#ç”¨æˆ·éƒ¨é—¨ç®¡ç†)
18. [åˆ†ç»„æƒé™ç®¡ç†](#åˆ†ç»„æƒé™ç®¡ç†)
19. [æ•°æ®åˆ†ææ¨¡å—](#æ•°æ®åˆ†ææ¨¡å—)
20. [é”™è¯¯å¤„ç†è§„èŒƒ](#é”™è¯¯å¤„ç†è§„èŒƒ)

---

## é¡¹ç›®æ¦‚è¿°

**çš–ç¾æ™ºè„‘**æ˜¯åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿï¼Œä¸ºå®‰å¾½å‡ºå…¥å¢ƒè¾¹é˜²æ£€æŸ¥æ€»ç«™æä¾›ä¸“ä¸šçŸ¥è¯†åº“é—®ç­”æœåŠ¡ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ” **ä¸šåŠ¡é—®ç­”** - åŸºäºçŸ¥è¯†åº“çš„æ™ºèƒ½é—®ç­”
- ğŸ’¬ **æ™ºèƒ½å¯¹è¯** - æ”¯æŒä¸Šä¸‹æ–‡çš„å¤šè½®å¯¹è¯
- ğŸ“š **è¾¹æ£€æ™ºå­¦** - åœ¨çº¿è€ƒè¯•ä¸å­¦ä¹ ç³»ç»Ÿ
- ğŸ“ **å…¬æ–‡åŠ©æ‰‹** - æ™ºèƒ½å†™ä½œè¾…åŠ©
- ğŸ“ **12367åŠ©æ‰‹** - ä¸“é—¨çš„å’¨è¯¢é—®ç­”
- ğŸ“Š **æ•°ç ”æŠ¥å‘Š** - æ•°æ®åˆ†ææŠ¥å‘Šç”Ÿæˆ

---

## æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Vue 3 + TypeScript
- **UIåº“**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Vuex
- **è·¯ç”±**: Vue Router
- **HTTPå®¢æˆ·ç«¯**: Axios
- **æ„å»ºå·¥å…·**: Vue CLI

### åç«¯æœåŠ¡æ¶æ„

é¡¹ç›®é‡‡ç”¨**å¾®æœåŠ¡æ¶æ„**ï¼ŒåŒ…å«ä¸‰ä¸ªç‹¬ç«‹çš„åç«¯æœåŠ¡ï¼š

| æœåŠ¡åç§° | ç«¯å£ | ç”¨é€” | HTTPå®ä¾‹ |
|---------|------|------|----------|
| ä¸»åç«¯æœåŠ¡ | 3000 | ç”¨æˆ·ç®¡ç†ã€æƒé™ã€åé¦ˆç­‰ | `http` |
| LLMæœåŠ¡ | 8000 | çŸ¥è¯†é—®ç­”ã€å¯¹è¯ã€æ—¥å¿—ç­‰ | `llmHttp` |
| MCQæœåŠ¡ | 9000 | é¢˜åº“ç®¡ç†ã€è€ƒè¯•ç³»ç»Ÿ | `mcqHttp` |

### Nginxåå‘ä»£ç†é…ç½®

```nginx
# ä¸»åç«¯æœåŠ¡
location /api {
    proxy_pass http://localhost:3000;
}

# LLMæœåŠ¡
location /llm {
    proxy_pass http://localhost:5000;
}

# MCQæœåŠ¡
location /mcq_public {
    proxy_pass http://localhost:9000;
}
```

---

## ç¯å¢ƒé…ç½®

### ç¯å¢ƒå˜é‡

**å¼€å‘ç¯å¢ƒ** (`.env.development`):
```bash
VUE_APP_API_BASE_URL=/api
VUE_APP_LLM_BASE_URL=/llm/api
VUE_APP_MCQ_BASE_URL=/mcq_public
VUE_APP_WRITER_URL=/llm/api
VUE_APP_OCR_BASE_URL=http://53.3.1.2:9000
VUE_APP_SHOW_HIDDEN_NODES=false
```

**ç”Ÿäº§ç¯å¢ƒ** (`.env.production`):
```bash
VUE_APP_API_BASE_URL=/api
VUE_APP_LLM_BASE_URL=/llm/api
VUE_APP_MCQ_BASE_URL=/mcq_public
```

### HTTPå®¢æˆ·ç«¯é…ç½®

#### 1. http - ä¸»åç«¯æœåŠ¡

```typescript
// æ–‡ä»¶: src/config/api/http.ts
baseURL: /api
timeout: 30000
headers: {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer {jwt_token}',
  'X-User-Role': '{user.role}',
  'X-User-Name': '{user.username}'
}
```

#### 2. llmHttp - LLMæœåŠ¡

```typescript
// æ–‡ä»¶: src/config/api/llmHttp.ts
baseURL: /llm/api
timeout: 90000
headers: {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer {multi_turn_chat_jwt}',
  'X-User-Role': '{user.role}',
  'X-User-Name': '{user.username}'
}
```

#### 3. mcqHttp - MCQæœåŠ¡

```typescript
// æ–‡ä»¶: src/config/api/mcqHttp.ts
baseURL: /mcq_public
timeout: 60000
headers: {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer {jwt_token}'
}
```

---

## è®¤è¯ä¸æˆæƒ

### Tokenç®¡ç†

| Tokenç±»å‹ | å­˜å‚¨é”® | ç”¨é€” | æœ‰æ•ˆæœŸ |
|----------|--------|------|--------|
| ä¸»Token | `jwt_token` | ä¸»åç«¯ã€MCQæœåŠ¡è®¤è¯ | 7å¤© |
| å¯¹è¯Token | `multi_turn_chat_jwt` | LLMæœåŠ¡è®¤è¯ | 7å¤© |

### ç”¨æˆ·è§’è‰²

| è§’è‰² | æƒé™è¯´æ˜ |
|------|---------|
| `USER` | æ™®é€šç”¨æˆ·ï¼ŒåŸºç¡€é—®ç­”åŠŸèƒ½ |
| `ADMIN` | ç®¡ç†å‘˜ï¼Œç”¨æˆ·ç®¡ç†ã€é¢˜åº“ç®¡ç† |
| `SUPER_ADMIN` | è¶…çº§ç®¡ç†å‘˜ï¼Œæ‰€æœ‰æƒé™ |
| `BJZX_ADMIN` | è¾¹æ£€æ™ºå­¦ç®¡ç†å‘˜ï¼Œé¢˜åº“å’Œè€ƒè¯•ç®¡ç† |

### ç”¨æˆ·çŠ¶æ€

| çŠ¶æ€å€¼ | è¯´æ˜ |
|-------|------|
| `1` | æ­£å¸¸ |
| `0` | å¾…å®¡æ ¸ |
| `-1` | å·²å°ç¦ |
| `-2` | å®¡æ ¸æœªé€šè¿‡ |

---

## ç”¨æˆ·è®¤è¯æ¨¡å—

### 1. ç”¨æˆ·ç™»å½•

**æ¥å£**: `POST /user/account/token/`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: æ— éœ€

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "string",
  "password": "string"
}
```

**å“åº”**:
```json
{
  "success": true,
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "zq",
      "role": "SUPER_ADMIN",
      "status": 1
    }
  }
}
```

**ä¸šåŠ¡é€»è¾‘**:
1. éªŒè¯ç”¨æˆ·åå¯†ç 
2. æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼ˆstatus=0è¿”å›"å¾…å®¡æ ¸"ï¼Œstatus=-1è¿”å›"å·²å°ç¦"ï¼‰
3. ç”ŸæˆJWT Token
4. è¿”å›ç”¨æˆ·ä¿¡æ¯å’ŒToken

---

### 2. ç”¨æˆ·æ³¨å†Œ

**æ¥å£**: `POST /user/account/register/`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: æ— éœ€

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "string",
  "password": "string",
  "policeId": "string",
  "idCardNumber": "string"
}
```

**å“åº”**:
```json
{
  "success": true,
  "code": 200,
  "message": "æ³¨å†ŒæˆåŠŸï¼Œç­‰å¾…ç®¡ç†å‘˜å®¡æ‰¹",
  "data": {}
}
```

**ä¸šåŠ¡é€»è¾‘**:
1. éªŒè¯ç”¨æˆ·åå”¯ä¸€æ€§
2. éªŒè¯è­¦å·å’Œèº«ä»½è¯å·æ ¼å¼
3. å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptï¼‰
4. **é»˜è®¤status=0ï¼ˆå¾…å®¡æ ¸ï¼‰**
5. è¿”å›æ³¨å†ŒæˆåŠŸæç¤º

---

### 3. è·å–ç”¨æˆ·ä¿¡æ¯

**æ¥å£**: `GET /user/account/info/`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦ï¼ˆBearer Tokenï¼‰

**å“åº”**:
```json
{
  "success": true,
  "code": 200,
  "data": {
    "id": 1,
    "username": "zq",
    "role": "SUPER_ADMIN",
    "status": 1,
    "email": null,
    "policeId": "123456",
    "idCardNumber": "320106199001011234",
    "hasChangedName": false,
    "department": "å‡ºå…¥å¢ƒç®¡ç†å±€",
    "groups": ["admin_group"]
  }
}
```

---

### 4. ä¿®æ”¹å¯†ç 

**æ¥å£**: `POST /auth/change_password`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "id": "string",
  "username": "string",
  "oldPassword": "string",
  "newPassword": "string"
}
```

---

### 5. ä¿®æ”¹ç”¨æˆ·å

**æ¥å£**: `POST /auth/change_username`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "id": "string",
  "newUsername": "string"
}
```

**ä¸šåŠ¡é€»è¾‘**:
- ç”¨æˆ·åªèƒ½ä¿®æ”¹ä¸€æ¬¡ç”¨æˆ·å
- ä¿®æ”¹åè®¾ç½® `hasChangedName=true`

---

### 6. å¿˜è®°å¯†ç 

**æ¥å£**: `POST /auth/forget`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: æ— éœ€

---

## ç®¡ç†å‘˜æ¨¡å—

### 1. è·å–ç”¨æˆ·åˆ—è¡¨

**æ¥å£**: `GET /api/admin/users/list/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN æˆ– SUPER_ADMIN

**å“åº”**:
```json
{
  "success": true,
  "code": 200,
  "data": {
    "list": [
      {
        "id": 123,
        "username": "user01",
        "email": "user@example.com",
        "role": "USER",
        "status": 1,
        "created_at": "2025-01-20 10:30:00",
        "policeId": "123456",
        "department": "å‡ºå…¥å¢ƒç®¡ç†å±€"
      }
    ]
  }
}
```

---

### 2. è·å–å¾…å®¡æ ¸ç”¨æˆ·åˆ—è¡¨

**æ¥å£**: `GET /api/admin/users/pending/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN æˆ– SUPER_ADMIN

**å“åº”**:
```json
{
  "success": true,
  "code": 200,
  "data": {
    "list": [
      {
        "id": 124,
        "username": "newuser",
        "policeId": "262841",
        "idCardNumber": "320106199001011234",
        "created_at": "2025-01-29 10:00:00",
        "status": 0
      }
    ]
  }
}
```

---

### 3. æ‰¹å‡†ç”¨æˆ·

**æ¥å£**: `POST /api/admin/users/approve/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN æˆ– SUPER_ADMIN

**è¯·æ±‚å‚æ•°**:
```json
{
  "id": 124,
  "username": "newuser"
}
```

**ä¸šåŠ¡é€»è¾‘**:
- å°†ç”¨æˆ·statusä»0æ”¹ä¸º1
- è®°å½•å®¡æ‰¹æ—¥å¿—

---

### 4. æ‹’ç»ç”¨æˆ·

**æ¥å£**: `POST /api/admin/users/reject/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN æˆ– SUPER_ADMIN

**è¯·æ±‚å‚æ•°**:
```json
{
  "id": 124,
  "username": "newuser"
}
```

**ä¸šåŠ¡é€»è¾‘**:
- åˆ é™¤ç”¨æˆ·è®°å½•æˆ–è®¾ç½®status=-2
- è®°å½•æ‹’ç»æ—¥å¿—

---

### 5. å°ç¦ç”¨æˆ·

**æ¥å£**: `POST /api/admin/users/ban/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN æˆ– SUPER_ADMIN

**è¯·æ±‚å‚æ•°**:
```json
{
  "id": 123,
  "username": "user01"
}
```

---

### 6. è§£å°ç”¨æˆ·

**æ¥å£**: `POST /api/admin/users/unban/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN æˆ– SUPER_ADMIN

---

## è¶…çº§ç®¡ç†å‘˜æ¨¡å—

### 1. åˆ›å»ºç®¡ç†å‘˜

**æ¥å£**: `POST /api/admin/create-admin/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: SUPER_ADMIN

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "admin01",
  "password": "password123",
  "policeId": "123456",
  "idCardNumber": "320106199001011234",
  "email": "admin@example.com"
}
```

---

### 2. è·å–ç®¡ç†å‘˜åˆ—è¡¨

**æ¥å£**: `GET /api/admin/list-admins/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: SUPER_ADMIN

---

### 3. é™çº§ç®¡ç†å‘˜

**æ¥å£**: `POST /api/admin/downgrade-admin/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: SUPER_ADMIN

---

### 4. æå‡ç”¨æˆ·ä¸ºç®¡ç†å‘˜

**æ¥å£**: `POST /api/admin/upgrade-admin/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: SUPER_ADMIN

---

### 5. è®¾ç½®è¾¹æ£€æ™ºå­¦ç®¡ç†å‘˜

**æ¥å£**: `POST /api/admin/users/set-bjzx-admin/`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: SUPER_ADMIN

---

## çŸ¥è¯†é—®ç­”æ¨¡å—

### 1. å•è½®çŸ¥è¯†é—®ç­”ï¼ˆæµå¼ï¼‰

**æ¥å£**: `POST {LLM_BASE_URL}/knowledge_chat`  
**å®Œæ•´URL**: `http://domain/llm/api/knowledge_chat`  
**HTTPå®ä¾‹**: ä½¿ç”¨åŸç”Ÿfetchï¼ˆæµå¼å“åº”ï¼‰  
**è®¤è¯**: å¯é€‰

**è¯·æ±‚å‚æ•°**:
```json
{
  "question": "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
  "session_id": null,
  "thinking": true,
  "model_id": "qwen3-32b",
  "rerank_top_n": 10,
  "use_insert_block": false,
  "insert_block_llm_id": null,
  "user_id": 123
}
```

**å“åº”æ ¼å¼**: Server-Sent Events (SSE)

**SSEæ¶ˆæ¯ç±»å‹**:

| å‰ç¼€ | æ ¼å¼ | è¯´æ˜ |
|------|------|------|
| SESSION | `data: SESSION:{session_id}` | ä¼šè¯ID |
| THINK | `data: THINK:{content}` | æ€è€ƒè¿‡ç¨‹ï¼ˆæµå¼ï¼‰ |
| CONTENT | `data: CONTENT:{content}` | å›ç­”å†…å®¹ï¼ˆæµå¼ï¼‰ |
| SOURCE | `data: SOURCE:{json}` | å‚è€ƒæ¥æº |
| SUB_QUESTIONS | `data: SUB_QUESTIONS:{json}` | å­é—®é¢˜ |
| KEYWORDS | `data: KEYWORDS:{json}` | å…³é”®è¯ |
| ERROR | `data: ERROR:{message}` | é”™è¯¯ä¿¡æ¯ |
| DONE | `data: DONE:` | æµå¼å®Œæˆ |

**SOURCE JSONç»“æ„**:
```json
{
  "id": "chunk_123",
  "fileName": "æŠ¤ç…§åŠç†æŒ‡å—.pdf",
  "content": "æŠ¤ç…§åŠç†éœ€è¦ä»¥ä¸‹ææ–™...",
  "initialScore": 0.85,
  "rerankedScore": 0.92,
  "canAnswer": true,
  "keyPassage": "å…³é”®æ®µè½",
  "url": "http://...",
  "retrievalSources": ["vector", "keyword"],
  "vectorScore": 0.85,
  "bm25Score": 0.78,
  "vectorRank": 1,
  "bm25Rank": 2,
  "matchedKeywords": ["æŠ¤ç…§", "åŠç†"],
  "isHidden": false,
  "hiddenKbName": null
}
```

**å‰ç«¯è°ƒç”¨ç¤ºä¾‹**:
```javascript
const response = await fetch('/llm/api/knowledge_chat', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  },
  body: JSON.stringify({
    question: "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
    thinking: true,
    model_id: "qwen3-32b"
  })
});

const reader = response.body.getReader();
const decoder = new TextDecoder();

while (true) {
  const { done, value } = await reader.read();
  if (done) break;
  
  const text = decoder.decode(value);
  // å¤„ç†SSEæ¶ˆæ¯
}
```

---

### 2. 12367çŸ¥è¯†é—®ç­”

**æ¥å£**: `POST {LLM_BASE_URL}/knowledge_chat_12367`  
**è¯´æ˜**: å‚æ•°å’Œå“åº”æ ¼å¼åŒå•è½®é—®ç­”

---

### 3. MCQç­–ç•¥åˆ¤æ–­

**æ¥å£**: `POST {LLM_BASE_URL}/mcq_strategy`  
**ç”¨é€”**: åˆ¤æ–­é¢˜ç›®ç±»å‹å’Œç­”é¢˜ç­–ç•¥

---

### 4. MCQæ ¼å¼åŒ–

**æ¥å£**: `POST {LLM_BASE_URL}/mcq_format`  
**ç”¨é€”**: æ ¼å¼åŒ–é¢˜ç›®æ–‡æœ¬

---

### 5. MCQç­”æ¡ˆæ€»ç»“

**æ¥å£**: `POST {LLM_BASE_URL}/mcq_summarize`  
**ç”¨é€”**: æ€»ç»“ç­”æ¡ˆè¦ç‚¹

---

## å¤šè½®å¯¹è¯æ¨¡å—

### 1. åˆ›å»ºæ–°ä¼šè¯

**æ¥å£**: `POST /conversation/new`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

**å“åº”**:
```json
{
  "session_id": "123_a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "message": "æ–°ä¼šè¯åˆ›å»ºæˆåŠŸ"
}
```

**ä¼šè¯IDæ ¼å¼**: `{user_id}_{uuid}`

---

### 2. å¤šè½®å¯¹è¯é—®ç­”ï¼ˆæµå¼ï¼‰

**æ¥å£**: `POST {LLM_BASE_URL}/knowledge_chat_conversation`  
**HTTPå®ä¾‹**: ä½¿ç”¨åŸç”Ÿfetch  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "question": "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
  "session_id": "123_a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "thinking": true,
  "model_id": "qwen3-32b",
  "rerank_top_n": 10
}
```

**å“åº”æ ¼å¼**: SSEï¼ˆåŒå•è½®é—®ç­”ï¼‰

---

### 3. æ¸…ç©ºä¼šè¯

**æ¥å£**: `POST /conversation/clear`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "session_id": "123_uuid"
}
```

---

### 4. è·å–ä¼šè¯ç»Ÿè®¡

**æ¥å£**: `POST /conversation/statistics`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

**å“åº”**:
```json
{
  "data": {
    "session_id": "123_uuid",
    "message_count": 10,
    "total_tokens": 5432,
    "create_time": "2025-01-20T10:30:00",
    "last_update_time": "2025-01-20T11:45:00"
  }
}
```

---

### 5. è·å–ä¼šè¯åˆ—è¡¨

**æ¥å£**: `POST /conversation/sessions/list`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "page": 1,
  "page_size": 20,
  "sort_by": "last_update"
}
```

**å“åº”**:
```json
{
  "data": {
    "total": 50,
    "sessions": [
      {
        "session_id": "123_uuid-1",
        "user_id": 123,
        "title": "å…³äºæŠ¤ç…§åŠç†çš„å’¨è¯¢",
        "first_message": "æˆ‘æƒ³é—®ä¸€ä¸‹æŠ¤ç…§åŠç†...",
        "last_message": "å¥½çš„ï¼Œè°¢è°¢",
        "message_count": 5,
        "total_tokens": 1234,
        "create_time": "2025-01-20T10:30:00",
        "last_update_time": "2025-01-20T11:00:00"
      }
    ],
    "page": 1,
    "page_size": 20
  }
}
```

---

### 6. è·å–ä¼šè¯å†å²

**æ¥å£**: `POST /conversation/sessions/{session_id}/history`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "limit": 50,
  "offset": 0,
  "order": "asc"
}
```

**å“åº”**:
```json
{
  "data": {
    "session_id": "123_uuid",
    "total_messages": 10,
    "messages": [
      {
        "turn_id": "turn_uuid_1",
        "user_query": "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
        "assistant_response": "æŠ¤ç…§åŠç†éœ€è¦ä»¥ä¸‹ææ–™ï¼š...",
        "timestamp": "2025-01-20T10:30:15",
        "context_docs": ["æŠ¤ç…§åŠç†è§„å®š.pdf"],
        "token_count": 245
      }
    ]
  }
}
```

---

### 7. è·å–ä¼šè¯è¯¦æƒ…

**æ¥å£**: `POST /conversation/sessions/{session_id}/info`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 8. åˆ é™¤ä¼šè¯

**æ¥å£**: `POST /conversation/sessions/{session_id}/delete`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 9. æ¸…é™¤ä¼šè¯ç¼“å­˜

**æ¥å£**: `POST /conversation/cache/clear`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ç®¡ç†å‘˜

---

## åé¦ˆæ¨¡å—

### 1. æäº¤ç‚¹èµåé¦ˆ

**æ¥å£**: `POST /feedback/like`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "question": "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
  "answer": "æŠ¤ç…§åŠç†éœ€è¦ä»¥ä¸‹ææ–™ï¼š...",
  "modelId": "qwen3-32b",
  "feedbackType": "LIKE",
  "source": [
    {
      "id": "chunk_123",
      "fileName": "æŠ¤ç…§åŠç†æŒ‡å—.pdf",
      "content": "..."
    }
  ]
}
```

---

### 2. æäº¤ç‚¹è¸©åé¦ˆ

**æ¥å£**: `POST /feedback/dislike`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚å‚æ•°**:
```json
{
  "question": "string",
  "answer": "string",
  "source": [],
  "reason": "å›ç­”ä¸å‡†ç¡®",
  "feedbackType": "DISLIKE",
  "modelId": "qwen3-32b",
  "reporterName": "å¼ ä¸‰",
  "reporterUnit": "å‡ºå…¥å¢ƒç®¡ç†å±€"
}
```

---

### 3. è·å–åé¦ˆåˆ—è¡¨

**æ¥å£**: `GET /feedback/show/list`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 4. è·å–åé¦ˆè¯¦æƒ…

**æ¥å£**: `GET /feedback/show/{feedbackId}`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

## é¢˜åº“ç®¡ç†æ¨¡å—(MCQ)

### 1. ä¸Šä¼ é¢˜ç›®æ–‡ä»¶

**æ¥å£**: `POST /upload`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

**è¯·æ±‚æ ¼å¼**: `multipart/form-data`

**Form Data**:
- `file`: .docx æˆ– .txt æ–‡ä»¶

**å“åº”**:
```json
{
  "ok": true,
  "items": [
    {
      "stem": "é¢˜ç›®å†…å®¹",
      "options": {
        "A": "é€‰é¡¹A",
        "B": "é€‰é¡¹B",
        "C": "é€‰é¡¹C",
        "D": "é€‰é¡¹D"
      },
      "answer": "A",
      "explain_original": "åŸå§‹è§£æ"
    }
  ]
}
```

---

### 2. æ‰¹é‡ä¿å­˜é¢˜ç›®

**æ¥å£**: `POST /bank/bulk_upsert`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

---

### 3. æ‰¹é‡æ›´æ–°é¢˜ç›®

**æ¥å£**: `POST /bank/bulk_update`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

---

### 4. æ‰¹é‡æ‹’ç»é¢˜ç›®

**æ¥å£**: `POST /bank/bulk_reject`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

---

### 5. è·å–é¢˜åº“åˆ—è¡¨

**æ¥å£**: `GET /bank/list`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

**Queryå‚æ•°**:
- `status`: é¢˜ç›®çŠ¶æ€ï¼ˆpending/approved/rejectedï¼‰
- `source`: æ¥æº
- `page`: é¡µç 
- `page_size`: æ¯é¡µæ•°é‡

---

### 6. å¯¼å‡ºé¢˜åº“ä¸ºWord

**æ¥å£**: `POST /bank/export_docx`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

---

### 7. ç”Ÿæˆè¯•å·

**æ¥å£**: `POST /bank/generate_paper`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

---

### 8. è·å–é¢˜ç›®æ¥æºåˆ—è¡¨

**æ¥å£**: `GET /bank/sources`  
**HTTPå®ä¾‹**: `mcqHttp`  
**è®¤è¯**: éœ€è¦

---

## è€ƒè¯•æ¨¡å—

### 1. è·å–å¼€æ”¾è¯•å·åˆ—è¡¨

**æ¥å£**: `GET /papers/list_open`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 2. è·å–æ‰€æœ‰è¯•å·åˆ—è¡¨

**æ¥å£**: `GET /papers/list_all`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 3. æŸ¥çœ‹è¯•å·è¯¦æƒ…

**æ¥å£**: `GET /papers/view`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 4. åˆ›å»ºè¯•å·

**æ¥å£**: `POST /papers/create`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 5. å¼€å§‹è€ƒè¯•

**æ¥å£**: `POST /exam/start`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 6. æäº¤è€ƒè¯•

**æ¥å£**: `POST /exam/submit`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 7. æŸ¥çœ‹è€ƒè¯•ç»“æœ

**æ¥å£**: `GET /exam/review`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 8. å‘å¸ƒè€ƒè¯•

**æ¥å£**: `POST /exam/publish`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 9. è·å–å·²å‘å¸ƒè€ƒè¯•åˆ—è¡¨

**æ¥å£**: `GET /exam/published`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 10. å–æ¶ˆå·²å‘å¸ƒè€ƒè¯•

**æ¥å£**: `POST /exam/cancel`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 11. è·å–è€ƒè¯•é€šçŸ¥ï¼ˆå­¦ç”Ÿç«¯ï¼‰

**æ¥å£**: `GET /exam/notifications`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 12. è·å–æˆç»©ç»Ÿè®¡

**æ¥å£**: `GET /exam/grades_stats`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

## çŸ¥è¯†åº“ç®¡ç†æ¨¡å—

### 1. ä¸Šä¼ æ–‡ä»¶

**æ¥å£**: `POST /knowledge/upload`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦ + çŸ¥è¯†åº“å£ä»¤

**Headers**:
```
Authorization: Bearer {token}
X-KB-PASSWORD: {kb_password}
Content-Type: multipart/form-data
```

**Form Data**:
- `file`: æ–‡ä»¶ï¼ˆæ”¯æŒtxt, md, docx, doc, pdf, csv, json, html, htmï¼‰
- `kb`: çŸ¥è¯†åº“ç±»å‹ï¼ˆgeneral/visa_free/airline/general_b/hiddenï¼‰
- `auto_rebuild`: æ˜¯å¦è‡ªåŠ¨é‡å»ºï¼ˆtrue/falseï¼‰

**å“åº”**:
```json
{
  "ok": true,
  "message": "å·²æ¥æ”¶ï¼Œå¼€å§‹é‡å»º",
  "file_name": "è¾¹æ£€ä¸šåŠ¡è§„èŒƒ.docx",
  "kb_type": "general"
}
```

---

### 2. åˆ—å‡ºæ–‡ä»¶

**æ¥å£**: `GET /knowledge/list_files?kb=general`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: æ— éœ€

**å“åº”**:
```json
{
  "ok": true,
  "kb_type": "general",
  "kb_name": "é€šç”¨çŸ¥è¯†åº“",
  "files": [
    {
      "name": "è¾¹æ£€ä¸šåŠ¡è§„èŒƒ.docx",
      "size": 102400,
      "modified": "2025-01-15T10:30:00"
    }
  ],
  "total_count": 2,
  "total_size": 358400
}
```

---

### 3. åˆ é™¤æ–‡ä»¶

**æ¥å£**: `POST /knowledge/delete_file`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦ + çŸ¥è¯†åº“å£ä»¤

**è¯·æ±‚å‚æ•°**:
```json
{
  "kb": "general",
  "file_name": "è¾¹æ£€ä¸šåŠ¡è§„èŒƒ.docx"
}
```

**å“åº”**:
```json
{
  "ok": true,
  "message": "æ–‡ä»¶åŠå¯¹åº”å‘é‡å·²åˆ é™¤ï¼Œå³æ—¶ç”Ÿæ•ˆã€‚",
  "need_rebuild": false,
  "kb_type": "general",
  "kb_name": "é€šç”¨çŸ¥è¯†åº“"
}
```

---

### 4. æŸ¥è¯¢æ›´æ–°çŠ¶æ€

**æ¥å£**: `GET /knowledge/update_status?kb=general`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: æ— éœ€

**å“åº”**:
```json
{
  "ok": true,
  "data": {
    "general": {
      "kb_type": "general",
      "updating": false,
      "progress": "æ›´æ–°å®Œæˆ",
      "file_count": 50,
      "started_at": "2025-01-15T10:00:00",
      "finished_at": "2025-01-15T10:05:30",
      "duration_seconds": 330.5,
      "last_error": ""
    }
  }
}
```

---

### 5. å¿«é€Ÿæ£€æŸ¥æ›´æ–°ä¸­

**æ¥å£**: `GET /knowledge/is_updating?kb=general`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: æ— éœ€

**å“åº”**:
```json
{
  "ok": true,
  "updating": false,
  "updating_kbs": []
}
```

---

### 6. æ‰‹åŠ¨è§¦å‘é‡å»º

**æ¥å£**: `POST /knowledge/rebuild`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦ + çŸ¥è¯†åº“å£ä»¤

**è¯·æ±‚å‚æ•°**:
```json
{
  "kb": "general"
}
```

---

## é—®ç­”æ—¥å¿—æ¨¡å—

### 1. è·å–æŸå¤©çš„æ—¥å¿—è®°å½•

**æ¥å£**: `GET /qa_logs/daily?date=2025-01-29&page=1&page_size=20`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

**Queryå‚æ•°**:
- `date`: æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
- `user_id`: ç”¨æˆ·IDï¼ˆå¯é€‰ï¼‰
- `username`: ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰
- `page`: é¡µç 
- `page_size`: æ¯é¡µæ•°é‡

**å“åº”**:
```json
{
  "data": {
    "date": "2025-01-29",
    "total": 100,
    "page": 1,
    "page_size": 20,
    "total_pages": 5,
    "logs": [
      {
        "id": "log_123",
        "timestamp": "2025-01-29T10:30:00",
        "type": "knowledge_qa",
        "question": "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
        "answer_preview": "æŠ¤ç…§åŠç†éœ€è¦ä»¥ä¸‹ææ–™ï¼š...",
        "metadata": {
          "ip": "192.168.1.100",
          "user_id": "123",
          "answer_type": "normal",
          "chat_mode": false,
          "insert_block_mode": false
        }
      }
    ]
  }
}
```

---

### 2. è·å–æ—¥å¿—è¯¦æƒ…

**æ¥å£**: `GET /qa_logs/detail?id=log_123&date=2025-01-29`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

**å“åº”**:
```json
{
  "data": {
    "id": "log_123",
    "timestamp": "2025-01-29T10:30:00",
    "type": "knowledge_qa",
    "question": "æŠ¤ç…§åŠç†éœ€è¦ä»€ä¹ˆææ–™ï¼Ÿ",
    "answer": "å®Œæ•´çš„å›ç­”å†…å®¹...",
    "metadata": {
      "ip": "192.168.1.100",
      "user_id": "123",
      "answer_type": "normal",
      "sources": [...]
    }
  }
}
```

---

### 3. è·å–æœ‰æ—¥å¿—çš„æ—¥æœŸåˆ—è¡¨

**æ¥å£**: `GET /qa_logs/dates`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

**å“åº”**:
```json
{
  "data": {
    "dates": ["2025-01-29", "2025-01-28", "2025-01-27"],
    "total": 3
  }
}
```

---

## å†™ä½œæ—¥å¿—æ¨¡å—

### 1. è·å–æŸå¤©çš„å†™ä½œæ—¥å¿—

**æ¥å£**: `GET /writing_logs/daily?date=2025-01-29`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

---

### 2. è·å–å†™ä½œæ—¥å¿—è¯¦æƒ…

**æ¥å£**: `GET /writing_logs/detail?id=log_123`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

---

## è§†é¢‘ä¸­å¿ƒæ¨¡å—

### 1. è·å–è§†é¢‘åˆ—è¡¨

**æ¥å£**: `GET /videos/list`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 2. ä¸Šä¼ è§†é¢‘

**æ¥å£**: `POST /videos/upload`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

---

### 3. è·å–è§†é¢‘ä¿¡æ¯

**æ¥å£**: `GET /videos/{videoId}/info`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 4. ä¸‹è½½è§†é¢‘

**æ¥å£**: `GET /videos/{videoId}/download`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 5. æµå¼æ’­æ”¾

**æ¥å£**: `GET /videos/{videoId}/stream`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 6. åˆ é™¤è§†é¢‘

**æ¥å£**: `POST /videos/{videoId}/delete`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

---

### 7. æ›´æ–°è§†é¢‘ä¿¡æ¯

**æ¥å£**: `POST /videos/{videoId}/update`  
**HTTPå®ä¾‹**: `llmHttp`  
**æƒé™**: ADMIN

---

## ç”¨æˆ·éƒ¨é—¨ç®¡ç†

### 1. è·å–ç”¨æˆ·éƒ¨é—¨ä¿¡æ¯

**æ¥å£**: `GET /user/department`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 2. æ›´æ–°ç”¨æˆ·éƒ¨é—¨

**æ¥å£**: `POST /user/department`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 3. è·å–éƒ¨é—¨åˆ—è¡¨

**æ¥å£**: `GET /departments`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

### 4. æ£€æŸ¥æ˜¯å¦éœ€è¦è®¾ç½®éƒ¨é—¨

**æ¥å£**: `GET /user/department/check`  
**HTTPå®ä¾‹**: `http`  
**è®¤è¯**: éœ€è¦

---

## åˆ†ç»„æƒé™ç®¡ç†

### 1. è·å–åˆ†ç»„åˆ—è¡¨

**æ¥å£**: `GET /api/admin/groups`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 2. åˆ›å»ºåˆ†ç»„

**æ¥å£**: `POST /api/admin/groups`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 3. è·å–åˆ†ç»„è¯¦æƒ…

**æ¥å£**: `GET /api/admin/groups/{groupId}`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 4. è·å–åˆ†ç»„æƒé™

**æ¥å£**: `GET /api/admin/groups/{groupId}/permissions`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

### 5. æ›´æ–°ç”¨æˆ·åˆ†ç»„

**æ¥å£**: `PUT /api/admin/groups/users/{userId}`  
**HTTPå®ä¾‹**: `http`  
**æƒé™**: ADMIN

---

## æ•°æ®åˆ†ææ¨¡å—

### 1. ç”Ÿæˆå®Œæ•´æŠ¥å‘Š

**æ¥å£**: `POST /entry-exit/generate-full-report`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

### 2. ç”Ÿæˆç»¼åˆæ‘˜è¦

**æ¥å£**: `POST /entryExit/summary-entrance-comprehensive`  
**HTTPå®ä¾‹**: `llmHttp`  
**è®¤è¯**: éœ€è¦

---

## é”™è¯¯å¤„ç†è§„èŒƒ

### HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | è¯´æ˜ | å¤„ç†æ–¹å¼ |
|-------|------|---------|
| 200 | æˆåŠŸ | æ­£å¸¸å¤„ç† |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•° |
| 401 | æœªè®¤è¯/Tokenå¤±æ•ˆ | é‡æ–°ç™»å½• |
| 403 | æƒé™ä¸è¶³ | æç¤ºæ— æƒé™ |
| 404 | èµ„æºä¸å­˜åœ¨ | æç¤ºèµ„æºä¸å­˜åœ¨ |
| 409 | å†²çªï¼ˆå¦‚ç”¨æˆ·åå·²å­˜åœ¨ï¼‰ | æç¤ºå†²çªä¿¡æ¯ |
| 460 | è‡ªå®šä¹‰å°ç¦çŠ¶æ€ç  | å¼ºåˆ¶ç™»å‡º |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æç¤ºç³»ç»Ÿé”™è¯¯ |

### é”™è¯¯å“åº”æ ¼å¼

**æ ‡å‡†æ ¼å¼**:
```json
{
  "success": false,
  "code": 400,
  "message": "é”™è¯¯æè¿°",
  "data": null
}
```

**è®¤è¯é”™è¯¯**:
```json
{
  "detail": "æœªæä¾›è®¤è¯ä»¤ç‰Œ"
}
```

**ä¸šåŠ¡é”™è¯¯**:
```json
{
  "type": "error",
  "content": "ä¸šåŠ¡é”™è¯¯æè¿°"
}
```

### å‰ç«¯é”™è¯¯å¤„ç†

```typescript
// æ–‡ä»¶: src/utils/errorHandler.ts
// ç»Ÿä¸€é”™è¯¯å¤„ç†å·¥å…·
export class ErrorHandler {
  static handleHttpError(error: AxiosError) {
    const status = error.response?.status;
    const bizCode = (error.response?.data as any)?.code;
    
    // 401/460/BANNED: å¼ºåˆ¶ç™»å‡º
    if (status === 401 || status === 460 || bizCode === 'BANNED') {
      forceLogout('ç™»å½•å·²å¤±æ•ˆæˆ–è´¦å·å·²è¢«å°ç¦ï¼Œè¯·é‡æ–°ç™»å½•');
    }
    
    // å…¶ä»–é”™è¯¯æç¤º
    ElMessage.error(error.message);
  }
}
```

---

## é™„å½•

### A. çŸ¥è¯†åº“ç±»å‹

| kbå€¼ | åç§° | è¯´æ˜ |
|------|------|------|
| `general` | é€šç”¨çŸ¥è¯†åº“ | é»˜è®¤çŸ¥è¯†åº“ï¼Œå­˜æ”¾é€šç”¨ä¸šåŠ¡æ–‡æ¡£ |
| `visa_free` | å…ç­¾çŸ¥è¯†åº“ | å„å›½å…ç­¾æ”¿ç­–ã€ç­¾è¯è§„å®š |
| `airline` | èˆªå¸çŸ¥è¯†åº“ | èˆªç©ºå…¬å¸è§„å®šã€æœºç»„äººå‘˜æ”¿ç­– |
| `general_b` | é€šç”¨çŸ¥è¯†åº“B | å¤‡ç”¨é€šç”¨çŸ¥è¯†åº“ |
| `hidden` | éšè—çŸ¥è¯†åº“ | é¢˜åº“ç›¸å…³çŸ¥è¯†ï¼Œç”¨äºè¾…åŠ©ç­”é¢˜ |

### B. æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

**çŸ¥è¯†åº“ä¸Šä¼ **: txt, md, docx, doc, pdf, csv, json, html, htm  
**é¢˜åº“ä¸Šä¼ **: docx, txt  
**æ•°æ®åˆ†æ**: xlsx, xls

### C. æœ¬åœ°å­˜å‚¨é”®å

| é”®å | ç”¨é€” |
|-----|------|
| `jwt_token` | ä¸»Token |
| `multi_turn_chat_jwt` | å¯¹è¯Token |
| `multi_turn_chat_session_id` | ä¼šè¯ID |
| `multi_turn_chat_user` | ç”¨æˆ·ä¿¡æ¯ |
| `kb_password` | çŸ¥è¯†åº“å£ä»¤ |

---

## æ–‡æ¡£ç»´æŠ¤

**ç»´æŠ¤è€…**: å‰ç«¯å¼€å‘å›¢é˜Ÿ  
**è”ç³»æ–¹å¼**: zq@zqsee.com  
**æœ€åæ›´æ–°**: 2026-01-29

---

**æ³¨æ„äº‹é¡¹**:

1. æ‰€æœ‰æ¶‰åŠæµå¼å“åº”çš„æ¥å£å¿…é¡»ä½¿ç”¨åŸç”Ÿfetchï¼Œä¸èƒ½ä½¿ç”¨axios
2. LLMæœåŠ¡çš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º90ç§’ï¼Œå› ä¸ºAIæ¨ç†éœ€è¦è¾ƒé•¿æ—¶é—´
3. çŸ¥è¯†åº“å†™æ“ä½œéœ€è¦åŒé‡è®¤è¯ï¼šBearer Token + X-KB-PASSWORD
4. ç”¨æˆ·æ³¨å†Œåé»˜è®¤status=0ï¼Œéœ€è¦ç®¡ç†å‘˜å®¡æ‰¹
5. ä¼šè¯IDæ ¼å¼ä¸º `{user_id}_{uuid}`ï¼Œç”±åç«¯ç”Ÿæˆ
6. SSEæ¶ˆæ¯ä¸­çš„ `<NEWLINE>` éœ€è¦åœ¨å‰ç«¯è½¬æ¢ä¸º `\n`
7. æ‰€æœ‰æ—¶é—´æ ¼å¼ä½¿ç”¨ISO 8601æ ‡å‡†

---

**æ–‡æ¡£ç»“æŸ**
